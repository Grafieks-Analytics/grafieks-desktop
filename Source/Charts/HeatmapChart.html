<html>
    <head>
        <meta charset="utf-8" />

        <!-- Load d3.js -->

        <script src="./Data/d3DefaultConfig.js"></script>
        <script src="./Data/d3.v4.min.js"></script>
        <title>Heatmap</title>
        <link rel="icon" href="logo.png" type="image/png" sizes="32x32" />
        <link rel="stylesheet" href="Data/general.css" />
    </head>
    <body>
        <!-- Create a div where the graph will take place -->
        <div
            id="my_dataviz"
            style="text-align: center; padding-top: 50px"
        ></div>
        <div id="tooltip"></div>

        <script>
            // Spectral color range
            const d3colors = [
                "#9e0142",
                "#a00343",
                "#a20643",
                "#a40844",
                "#a70b44",
                "#a90d45",
                "#ab0f45",
                "#ad1245",
                "#af1446",
                "#b11646",
                "#b31947",
                "#b51b47",
                "#b71d48",
                "#ba2048",
                "#bc2248",
                "#be2449",
                "#c02749",
                "#c12949",
                "#c32b4a",
                "#c52d4a",
                "#c7304a",
                "#c9324a",
                "#cb344b",
                "#cd364b",
                "#ce384b",
                "#d03b4b",
                "#d23d4b",
                "#d33f4b",
                "#d5414b",
                "#d7434b",
                "#d8454b",
                "#da474a",
                "#db494a",
                "#dd4b4a",
                "#de4d4a",
                "#df4f4a",
                "#e1514a",
                "#e2534a",
                "#e35549",
                "#e45749",
                "#e65949",
                "#e75b49",
                "#e85d49",
                "#e95f49",
                "#ea6149",
                "#eb6349",
                "#ec6549",
                "#ed6749",
                "#ee6a49",
                "#ef6c49",
                "#f06e4a",
                "#f0704a",
                "#f1724a",
                "#f2744b",
                "#f3774b",
                "#f3794c",
                "#f47b4d",
                "#f47e4d",
                "#f5804e",
                "#f6824f",
                "#f68550",
                "#f78750",
                "#f78951",
                "#f88c52",
                "#f88e53",
                "#f89154",
                "#f99356",
                "#f99557",
                "#f99858",
                "#fa9a59",
                "#fa9c5a",
                "#fa9f5c",
                "#fba15d",
                "#fba35e",
                "#fba660",
                "#fba861",
                "#fcaa62",
                "#fcad64",
                "#fcaf65",
                "#fcb167",
                "#fcb368",
                "#fcb56a",
                "#fdb86b",
                "#fdba6d",
                "#fdbc6e",
                "#fdbe70",
                "#fdc071",
                "#fdc273",
                "#fdc474",
                "#fdc676",
                "#fdc878",
                "#fdca79",
                "#fecc7b",
                "#fecd7d",
                "#fecf7e",
                "#fed180",
                "#fed382",
                "#fed584",
                "#fed685",
                "#fed887",
                "#feda89",
                "#fedb8b",
                "#fedd8d",
                "#fede8f",
                "#fee090",
                "#fee192",
                "#fee394",
                "#fee496",
                "#fee698",
                "#fee79a",
                "#fee89b",
                "#feea9d",
                "#feeb9f",
                "#feeca1",
                "#feeda2",
                "#feefa4",
                "#fef0a5",
                "#fef1a7",
                "#fef2a8",
                "#fdf3a9",
                "#fdf3aa",
                "#fdf4ab",
                "#fdf5ac",
                "#fcf6ad",
                "#fcf6ae",
                "#fcf7af",
                "#fbf7af",
                "#fbf8b0",
                "#faf8b0",
                "#faf9b0",
                "#f9f9b0",
                "#f9f9b0",
                "#f8f9b0",
                "#f7faaf",
                "#f7faaf",
                "#f6faae",
                "#f5faae",
                "#f4f9ad",
                "#f3f9ac",
                "#f2f9ac",
                "#f2f9ab",
                "#f0f9aa",
                "#eff8a9",
                "#eef8a8",
                "#edf8a7",
                "#ecf7a7",
                "#ebf7a6",
                "#e9f6a5",
                "#e8f6a4",
                "#e7f5a3",
                "#e5f5a2",
                "#e4f4a2",
                "#e2f3a1",
                "#e0f3a1",
                "#dff2a0",
                "#ddf1a0",
                "#dbf19f",
                "#d9f09f",
                "#d7ef9f",
                "#d6ee9f",
                "#d4ee9f",
                "#d2ed9e",
                "#d0ec9e",
                "#cdeb9f",
                "#cbea9f",
                "#c9e99f",
                "#c7e89f",
                "#c5e89f",
                "#c3e79f",
                "#c0e6a0",
                "#bee5a0",
                "#bce4a0",
                "#b9e3a0",
                "#b7e2a1",
                "#b4e1a1",
                "#b2e0a1",
                "#b0dfa1",
                "#addea2",
                "#abdda2",
                "#a8dca2",
                "#a6dba3",
                "#a3daa3",
                "#a0d9a3",
                "#9ed8a3",
                "#9bd7a3",
                "#99d6a4",
                "#96d5a4",
                "#94d4a4",
                "#91d3a4",
                "#8ed1a4",
                "#8cd0a4",
                "#89cfa5",
                "#87cea5",
                "#84cda5",
                "#82cba5",
                "#7fcaa6",
                "#7dc9a6",
                "#7ac7a6",
                "#77c6a6",
                "#75c5a7",
                "#73c3a7",
                "#70c2a8",
                "#6ec0a8",
                "#6bbea8",
                "#69bda9",
                "#66bba9",
                "#64b9aa",
                "#62b8aa",
                "#60b6ab",
                "#5db4ac",
                "#5bb2ac",
                "#59b0ad",
                "#57aeae",
                "#55acae",
                "#53aaaf",
                "#51a8af",
                "#50a6b0",
                "#4ea4b1",
                "#4ca2b1",
                "#4ba0b2",
                "#499db2",
                "#489bb3",
                "#4799b3",
                "#4697b3",
                "#4595b4",
                "#4492b4",
                "#4390b4",
                "#438eb4",
                "#428cb5",
                "#4289b5",
                "#4287b4",
                "#4285b4",
                "#4283b4",
                "#4280b4",
                "#437eb3",
                "#437cb3",
                "#447ab3",
                "#4577b2",
                "#4575b1",
                "#4673b1",
                "#4771b0",
                "#486eaf",
                "#4a6caf",
                "#4b6aae",
                "#4c68ad",
                "#4e65ac",
                "#4f63ab",
                "#5161aa",
                "#525fa9",
                "#545ca8",
                "#555aa7",
                "#5758a6",
                "#5956a5",
                "#5b53a4",
                "#5c51a3",
                "#5e4fa2",
            ];

            // Labels of row and columns
            var myGroups = ["A", "B", "C"];
            var myVars = [
                "v1",
                "v2",
                "v3",
                "v4",
                "v5",
                "v6",
                "v7",
                "v8",
                "v9",
                "v10",
            ];

            var data = [
                [
                    ["A", "v1", "30"],
                    ["A", "v3", "22"],
                    ["A", "v4", "14"],
                    ["A", "v5", "59"],
                    ["A", "v6", "52"],
                    ["A", "v7", "88"],
                    ["A", "v8", "20"],
                    ["A", "v9", "99"],
                    ["A", "v10", "66"],
                    ["B", "v1", "37"],
                    ["B", "v2", "50"],
                    ["B", "v3", "81"],
                    ["B", "v4", "79"],
                    ["B", "v5", "84"],
                    ["B", "v7", "82"],
                    ["B", "v8", "89"],
                    ["B", "v9", "6"],
                    ["B", "v10", "67"],
                    ["C", "v1", "96"],
                    ["C", "v2", "13"],
                    ["C", "v3", "98"],
                    ["C", "v4", "10"],
                    ["C", "v5", "86"],
                    ["C", "v6", "23"],
                    ["C", "v7", "74"],
                    ["C", "v9", "73"],
                    ["C", "v10", "40"],
                ],
                [myGroups, myVars],
            ];

            function drawChart(data, plottingConfiguration = {}) {
                var dataValues = data[0];

                let {
                    d3colorPalette,
                    paddingInner,
                    markerShape,
                    curveType,
                } = plottingConfiguration;
                if (!d3colorPalette) {
                    d3colorPalette = defaultD3Config.d3ColorPalette;
                }
                d3Colors = d3[d3colorPalette];

                if (!paddingInner) {
                    paddingInner = defaultD3Config.defaultPaddingInner;
                }

                // set the dimensions and margins of the graph
                d3.selectAll("#my_dataviz").html("");
                (margin = { top: 30, right: 30, bottom: 70, left: 60 }),
                    (width =
                        window.innerWidth - margin.left - margin.right - 20),
                    (height =
                        window.innerHeight - margin.top - margin.bottom - 70);

                // var margin = { top: 30, right: 30, bottom: 30, left: 30 },
                //     width = 1300 - margin.left - margin.right,
                //     height = 600 - margin.top - margin.bottom;

                // append the svg object to the body of the page
                var svg = d3
                    .select("#my_dataviz")
                    .append("svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr(
                        "transform",
                        "translate(" + margin.left + "," + margin.top + ")"
                    );

                // Build X scales and axis:
                var x = d3
                    .scaleBand()
                    .range([0, width])
                    .domain(myGroups)
                    .padding(0.01);
                svg.append("g")
                    .attr("class", "x-axis")
                    .attr("transform", "translate(0," + height + ")")
                    .call(d3.axisBottom(x).tickSizeOuter(0));

                // Build Y scales and axis:
                var y = d3
                    .scaleBand()
                    .range([height, 0])
                    .domain(myVars)
                    .padding(0.01);
                svg.append("g")
                    .attr("class", "y-axis")
                    .call(d3.axisLeft(y).tickSizeOuter(0));

                // Build color scale
                var myColor = d3
                    .scaleLinear()
                    .range([d3colors[0], d3colors[d3colors.length - 1]])
                    .domain([1, 100]);

                //Read the data
                // d3.csv("Data/heatmap.csv", function (data) {
                dataValues = data[0];
                svg.selectAll()
                    .data(dataValues, function (d) {
                        return d[0] + ":" + d[1];
                    })
                    .enter()
                    .append("rect")
                    .attr("x", function (d) {
                        return x(d[0]);
                    })
                    .attr("y", function (d) {
                        return y(d[1]);
                    })
                    .attr("width", x.bandwidth())
                    .attr("height", y.bandwidth())
                    .style("fill", function (d) {
                        return myColor(d[2]);
                    })
                    .attr("class", function (d, i) {
                        return "heatmap" + i;
                    })
                    .on("mouseover mousemove", function (d, i) {
                        var x_pos = d3.mouse(this)[0] + margin.left;
                        var y_pos = d3.mouse(this)[1];

                        d3.select("#tooltip")
                            .style("left", x_pos + "px")
                            .style("top", y_pos + "px")
                            .style("display", "block")
                            .style("z-index", 1000)
                            .style("postion", "absolute")
                            .html(
                                "Group: " +
                                    d[0] +
                                    "<br/>Variable: " +
                                    d[1] +
                                    "<br/>Value: " +
                                    d[2]
                            );
                        d3.select(".heatmap" + i).style("fill", d3colors[9]);
                    })
                    .on("mouseout", function (d, i) {
                        d3.select("#tooltip").style("display", "none");
                        d3.select(".heatmap" + i).style("fill", myColor(d[2]));
                    });
            }

            drawChart(data);
        </script>
    </body>
</html>
