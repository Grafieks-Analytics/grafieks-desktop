<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Horizontal Bar Chart</title>

    <script src="../../Assets/vendors/vega5.min.js"></script>
    <script src="../../Assets/vendors/vega-embed.js"></script>
  </head>

  <body>
    <center><div id="vis"></div></center>
    <script type="text/javascript">
      var config = {
        // default view background color
        // covers the entire view component
        background: "#fff",
        axis: {
          labelFont: "serif",
          labelFontSize: 16,
          tickWidth: 3,
          tickColor: "red"
        }
      };

      var spec = {
    $schema: "https://vega.github.io/schema/vega/v5.json",
    width: 600,
    height: 400,
    padding: 5,

    data: [
        {
            name: "table",
            values: [
                { category: "A", position: 0, value: 0.1 },
                { category: "A", position: 1, value: 0.6 },
                { category: "A", position: 2, value: 0.9 },
                { category: "A", position: 3, value: 0.4 },
                { category: "B", position: 0, value: 0.7 },
                { category: "B", position: 1, value: 0.2 },
                { category: "B", position: 2, value: 1.1 },
                { category: "B", position: 3, value: 0.8 },
                { category: "C", position: 0, value: 0.6 },
                { category: "C", position: 1, value: 0.1 },
                { category: "C", position: 2, value: 0.2 },
                { category: "C", position: 3, value: 0.7 }
            ]
        }
    ],

    scales: [
        {
            name: "yscale",
            type: "band",
            domain: { data: "table", field: "category" },
            range: "height",
            padding: 0.2
        },
        {
            name: "xscale",
            type: "linear",
            domain: { data: "table", field: "value" },
            range: "width",
            round: true,
            zero: true,
            nice: true
        },
        {
            name: "color",
            type: "ordinal",
            domain: { data: "table", field: "position" },
            range: { scheme: "category20" }
        }
    ],

    axes: [
        {
            orient: "left",
            scale: "yscale",
            tickSize: 0,
            labelPadding: 4,
            zindex: 1,
            domainColor: "#dfdfdf",
            ticks: false,
            labelColor: "#797979"
        },
        {
            orient: "bottom",
            scale: "xscale",
            domainColor: "#dfdfdf",
            ticks: false,
            labelColor: "#797979"
        }
    ],

    marks: [
        {
            type: "group",

            from: {
                facet: {
                    data: "table",
                    name: "facet",
                    groupby: "category"
                }
            },

            encode: {
                enter: {
                    y: { scale: "yscale", field: "category" }
                }
            },

            signals: [
                { name: "height", update: "bandwidth('yscale')" },
                {
                    name: "tooltip",
                    value: { s: 21 },
                    on: [
                        { events: "rect:mouseover", update: "datum" },
                        { events: "rect:mouseout", update: "{}" }
                    ]
                }
            ],

            scales: [
                {
                    name: "pos",
                    type: "band",
                    range: "height",
                    domain: { data: "facet", field: "position" }
                }
            ],

            marks: [
                {
                    name: "bars",
                    from: { data: "facet" },
                    type: "rect",
                    encode: {
                        enter: {
                            y: { scale: "pos", field: "position" },
                            height: { scale: "pos", band: 1 },
                            x: { scale: "xscale", field: "value" },
                            x2: { scale: "xscale", value: 0 },
                            fill: { scale: "color", field: "position" }
                        }
                    }
                },
                {
                    type: "text",
                    from: { data: "bars" },
                    encode: {
                        enter: {
                            x: { field: "x2", offset: -5 },
                            y: {
                                field: "y",
                                offset: { field: "height", mult: 0.5 }
                            },
                            fill: { value: "white" },
                            align: { value: "right" },
                            baseline: { value: "middle" },
                            text: { field: "datum.value" }
                        }
                    }
                }
            ]
        }
    ]
};

      vegaEmbed("#vis", spec, {
        config: config,
        tooltip: { theme: "dark" }
      })
        .then(function(result) {
          console.log(result);
        })
        .catch(console.error);
    </script>
  </body>
</html>
