<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tree Chart</title>

    <script src="../../Assets/vendors/vega5.min.js"></script>
    <script src="../../Assets/vendors/vega-embed.js"></script>
  </head>

  <body>
    <div id="vis"></div>
    <script type="text/javascript">
      var config = {
        // default view background color
        // covers the entire view component
        background: "#fff",
        axis: {
          labelFont: "serif",
          labelFontSize: 16,
          tickWidth: 3,
          tickColor: "red"
        }
      };

      var spec = {
    $schema: "https://vega.github.io/schema/vega/v5.json",
    width: 1000,
    height: 1600,
    padding: 5,

    signals: [
        {
            name: "labels",
            value: true,
            bind: { input: "checkbox" }
        },
        {
            name: "layout",
            value: "tidy",
            bind: { input: "radio", options: ["tidy", "cluster"] }
        },
        {
            name: "links",
            value: "diagonal",
            bind: {
                input: "select",
                options: ["line", "curve", "diagonal", "orthogonal"]
            }
        }
    ],

    data: [
        {
            name: "tree",
            url:
                "https://gist.githubusercontent.com/chilarai/60f60ea4ccba94ff919dfd0b1450c525/raw/6e14fae00591aef7967b1ca66ce6d527597d78b8/tree.json",
            transform: [
                {
                    type: "stratify",
                    key: "id",
                    parentKey: "parent"
                },
                {
                    type: "tree",
                    method: { signal: "layout" },
                    size: [{ signal: "height" }, { signal: "width - 100" }],
                    as: ["y", "x", "depth", "children"]
                }
            ]
        },
        {
            name: "links",
            source: "tree",
            transform: [
                { type: "treelinks" },
                {
                    type: "linkpath",
                    orient: "horizontal",
                    shape: { signal: "links" }
                }
            ]
        }
    ],

    scales: [
        {
            name: "color",
            type: "linear",
            range: { scheme: "magma" },
            domain: { data: "tree", field: "depth" },
            zero: true
        }
    ],

    marks: [
        {
            type: "path",
            from: { data: "links" },
            encode: {
                update: {
                    path: { field: "path" },
                    stroke: { value: "#ccc" }
                }
            }
        },
        {
            type: "symbol",
            from: { data: "tree" },
            encode: {
                enter: {
                    size: { value: 100 },
                    stroke: { value: "#fff" }
                },
                update: {
                    x: { field: "x" },
                    y: { field: "y" },
                    fill: { scale: "color", field: "depth" }
                }
            }
        },
        {
            type: "text",
            from: { data: "tree" },
            encode: {
                enter: {
                    text: { field: "name" },
                    fontSize: { value: 9 },
                    baseline: { value: "middle" }
                },
                update: {
                    x: { field: "x" },
                    y: { field: "y" },
                    dx: { signal: "datum.children ? -7 : 7" },
                    align: { signal: "datum.children ? 'right' : 'left'" },
                    opacity: { signal: "labels ? 1 : 0" }
                }
            }
        }
    ]
};

      vegaEmbed("#vis", spec, {
        config: config,
        tooltip: { theme: "dark" }
      })
        .then(function(result) {
          console.log(result);
        })
        .catch(console.error);
    </script>
  </body>
</html>
