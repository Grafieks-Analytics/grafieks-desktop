<!DOCTYPE html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Load d3.js -->
    <script src="./Data/d3.v4.min.js"></script>
    <script src="./Data/utils.js"></script>
    <script src="./Data/d3DefaultConfig.js"></script>
    <script src="Data/d3-scale-chromatic.v1.min.js"></script>
    <link rel="stylesheet" href="Data/general.css" />

    <title>Scatter Chart</title>
    <style>
        #xAxisLabelId {
            position: fixed;
            bottom: 15px;
            z-index: -1;
            height: 40px;
            /* background-color: red; */
        }
        #my_dataviz{
            margin-left: 0;
        }
    </style>
</head>
<body>
    <!-- <div style="text-align: center">
     
        <div id="my_dataviz"></div>
    </div> -->
    <div id="mainChartWindow" style="display: flex">
        <div id="yAxisDiv"></div>
        <div id="my_dataviz"></div>
        <div id="xAxisLabelId" style="position: fixed" ;></div>
    </div>
    <div id="tooltip"></div>
    <div id="legend"></div>

    <script>
        // Categories
        var categories = ["setosa", "versicolor", "virginica", "default"];
        //Read the data
        var data = [
            [
                ["5.1", "1.4", "setosa"],
                ["4.9", "1.4", "setosa"],
                ["4.7", "1.3", "setosa"],
                ["4.6", "1.5", "setosa"],
                ["5", "1.4", "setosa"],
                ["5.4", "1.7", "setosa"],
                ["4.6", "1.4", "setosa"],
                ["5", "1.5", "setosa"],
                ["4.4", "1.4", "setosa"],
                ["4.9", "1.5", "setosa"],
                ["5.4", "1.5", "setosa"],
                ["4.8", "1.6", "setosa"],
                ["4.8", "1.4", "setosa"],
                ["4.3", "1.1", "setosa"],
                ["5.8", "1.2", "setosa"],
                ["5.7", "1.5", "setosa"],
                ["5.4", "1.3", "setosa"],
                ["5.1", "1.4", "setosa"],
                ["5.7", "1.7", "setosa"],
                ["5.1", "1.5", "setosa"],
                ["5.4", "1.7", "setosa"],
                ["5.1", "1.5", "setosa"],
                ["4.6", "1", "setosa"],
                ["5.1", "1.7", "setosa"],
                ["4.8", "1.9", "setosa"],
                ["5", "1.6", "setosa"],
                ["5", "1.6", "setosa"],
                ["5.2", "1.5", "setosa"],
                ["5.2", "1.4", "setosa"],
                ["4.7", "1.6", "setosa"],
                ["4.8", "1.6", "setosa"],
                ["5.4", "1.5", "setosa"],
                ["5.2", "1.5", "setosa"],
                ["5.5", "1.4", "setosa"],
                ["4.9", "1.5", "setosa"],
                ["5", "1.2", "setosa"],
                ["5.5", "1.3", "setosa"],
                ["4.9", "1.4", "setosa"],
                ["4.4", "1.3", "setosa"],
                ["5.1", "1.5", "setosa"],
                ["5", "1.3", "setosa"],
                ["4.5", "1.3", "setosa"],
                ["4.4", "1.3", "setosa"],
                ["5", "1.6", "setosa"],
                ["5.1", "1.9", "setosa"],
                ["4.8", "1.4", "setosa"],
                ["5.1", "1.6", "setosa"],
                ["4.6", "1.4", "setosa"],
                ["5.3", "1.5", "setosa"],
                ["5", "1.4", "setosa"],
                ["7", "4.7", "versicolor"],
                ["6.4", "4.5", "versicolor"],
                ["6.9", "4.9", "versicolor"],
                ["5.5", "4", "versicolor"],
                ["6.5", "4.6", "versicolor"],
                ["5.7", "4.5", "versicolor"],
                ["6.3", "4.7", "versicolor"],
                ["4.9", "3.3", "versicolor"],
                ["6.6", "4.6", "versicolor"],
                ["5.2", "3.9", "versicolor"],
                ["5", "3.5", "versicolor"],
                ["5.9", "4.2", "versicolor"],
                ["6", "4", "versicolor"],
                ["6.1", "4.7", "versicolor"],
                ["5.6", "3.6", "versicolor"],
                ["6.7", "4.4", "versicolor"],
                ["5.6", "4.5", "versicolor"],
                ["5.8", "4.1", "versicolor"],
                ["6.2", "4.5", "versicolor"],
                ["5.6", "3.9", "versicolor"],
                ["5.9", "4.8", "versicolor"],
                ["6.1", "4", "versicolor"],
                ["6.3", "4.9", "versicolor"],
                ["6.1", "4.7", "versicolor"],
                ["6.4", "4.3", "versicolor"],
                ["6.6", "4.4", "versicolor"],
                ["6.8", "4.8", "versicolor"],
                ["6.7", "5", "versicolor"],
                ["6", "4.5", "versicolor"],
                ["5.7", "3.5", "versicolor"],
                ["5.5", "3.8", "versicolor"],
                ["5.5", "3.7", "versicolor"],
                ["5.8", "3.9", "versicolor"],
                ["6", "5.1", "versicolor"],
                ["5.4", "4.5", "versicolor"],
                ["6", "4.5", "versicolor"],
                ["6.7", "4.7", "versicolor"],
                ["6.3", "4.4", "versicolor"],
                ["5.6", "4.1", "versicolor"],
                ["5.5", "4", "versicolor"],
                ["5.5", "4.4", "versicolor"],
                ["6.1", "4.6", "versicolor"],
                ["5.8", "4", "versicolor"],
                ["5", "3.3", "versicolor"],
                ["5.6", "4.2", "versicolor"],
                ["5.7", "4.2", "versicolor"],
                ["5.7", "4.2", "versicolor"],
                ["6.2", "4.3", "versicolor"],
                ["5.1", "3", "versicolor"],
                ["5.7", "4.1", "versicolor"],
                ["6.3", "6", "virginica"],
                ["5.8", "5.1", "virginica"],
                ["7.1", "5.9", "virginica"],
                ["6.3", "5.6", "virginica"],
                ["6.5", "5.8", "virginica"],
                ["7.6", "6.6", "virginica"],
                ["4.9", "4.5", "virginica"],
                ["7.3", "6.3", "virginica"],
                ["6.7", "5.8", "virginica"],
                ["7.2", "6.1", "virginica"],
                ["6.5", "5.1", "virginica"],
                ["6.4", "5.3", "virginica"],
                ["6.8", "5.5", "virginica"],
                ["5.7", "5", "virginica"],
                ["5.8", "5.1", "virginica"],
                ["6.4", "5.3", "virginica"],
                ["6.5", "5.5", "virginica"],
                ["7.7", "6.7", "virginica"],
                ["7.7", "6.9", "virginica"],
                ["6", "5", "virginica"],
                ["6.9", "5.7", "virginica"],
                ["5.6", "4.9", "virginica"],
                ["7.7", "6.7", "virginica"],
                ["6.3", "4.9", "virginica"],
                ["6.7", "5.7", "virginica"],
                ["7.2", "6", "virginica"],
                ["6.2", "4.8", "virginica"],
                ["6.1", "4.9", "virginica"],
                ["6.4", "5.6", "virginica"],
                ["7.2", "5.8", "virginica"],
                ["7.4", "6.1", "virginica"],
                ["7.9", "6.4", "virginica"],
                ["6.4", "5.6", "virginica"],
                ["6.3", "5.1", "virginica"],
                ["6.1", "5.6", "virginica"],
                ["7.7", "6.1", "virginica"],
                ["6.3", "5.6", "virginica"],
                ["6.4", "5.5", "virginica"],
                ["6", "4.8", "virginica"],
                ["6.9", "5.4", "virginica"],
                ["6.7", "5.6", "virginica"],
                ["6.9", "5.1", "virginica"],
                ["5.8", "5.1", "virginica"],
                ["6.8", "5.9", "virginica"],
                ["6.7", "5.7", "virginica"],
                ["6.7", "5.2", "virginica"],
                ["6.3", "5", "virginica"],
                ["6.5", "5.2", "virginica"],
                ["6.2", "5.4", "virginica"],
                ["5.9", "5.1", "virginica"],
            ],
            ["Sepal_Length", "Sepal_Width", "Petal_Length"],
            categories,
        ];

        // When only numericals are passed
        // Send
        data = [
            [
                [0, 0], // This element is fixed
                [2121, 10], // Sum of population, sum of id
            ],
            ["population", "id"],
        ];

        // when categorical is also passed with numerical
        data = [
            [
                [524, 10, "India"], // Group them on the basis of categorical
                [4712, "12", "Bhutan"],
                [10, "13", "Bhutan"],
            ],
            ["population", "id", "country"],
            ["Nepal", "India", "Bhutan"],
        ];

        // when categorical is also passed with numerical
        data = [
            [
                [524, 10, "India"], // Group them on the basis of categorical
                [4712, "12", "Bhutan"],
                [10, "13", "Bhutan"],
            ],
            ["population", "id", "country"],
            ["Nepal", "India", "Bhutan"],
        ];

        function drawChart(data, plottingConfiguration = {}) {
            window.data = data;
            d3.selectAll("#my_dataviz").html("");
            console.log(data[1]);
            // xAxisLabel = data[1][0];
            // yAxisLabel = data[1][1];
            colorData = data[1][2];

            let {
                d3colorPalette,
                paddingInner,
                innerRadius,
                toolTip,
                legendConfig = defaultD3Config.defaultLegendConfig,
                labelConfig = defaultD3Config.defaultlabelConfig,
                gridConfig = defaultD3Config.defaultGridConfig,
                // font size
                xLabelfontSize = defaultD3Config.fontSize,
                yLabelfontSize = defaultD3Config.fontSize,
                xTickfontSize = defaultD3Config.fontSize,
                yTickfontSize = defaultD3Config.fontSize,
                dataLabelfontSize = defaultD3Config.fontSize,
                // font family
                xLabelfontFamily = defaultD3Config.fontFamily,
                yLabelfontFamily = defaultD3Config.fontFamily,
                xTickfontFamily = defaultD3Config.fontFamily,
                yTickfontFamily = defaultD3Config.fontFamily,
                dataLabelfontFamily = defaultD3Config.fontFamily,
                // font color
                xLabelfontColor = defaultD3Config.fontColor,
                yLabelfontColor = defaultD3Config.fontColor,
                xTickfontColor = defaultD3Config.fontColor,
                yTickfontColor = defaultD3Config.fontColor,
                dataLabelColor = defaultD3Config.fontColor,
                // xaxis setting
                xAxisConfig = defaultD3Config.xAxisConfig,
                yAxisConfig = defaultD3Config.yAxisConfig,
            } = plottingConfiguration;
            window.xLabelfontSize = xLabelfontSize;
            window.yLabelfontSize = yLabelfontSize;
            window.xTickfontSize = xTickfontSize;
            window.yTickfontSize = yTickfontSize;
            window.dataLabelfontSize = dataLabelfontSize;

            window.xLabelfontFamily = xLabelfontFamily;
            window.yLabelfontFamily = yLabelfontFamily;
            window.xTickfontFamily = xTickfontFamily;
            window.yTickfontFamily = yTickfontFamily;
            window.dataLabelfontFamily = dataLabelfontFamily;

            window.xLabelfontColor = xLabelfontColor;
            window.yLabelfontColor = yLabelfontColor;
            window.xTickfontColor = xTickfontColor;
            window.yTickfontColor = yTickfontColor;

            if (!d3colorPalette) {
                d3colorPalette = defaultD3Config.d3ColorPalette;
            }
            let { labelStatus, labelFormat } = labelConfig;
            let {
                xlabel,
                xboldLabel,
                xitalicLabel,
                xboldTick,
                xitalicTick,
                xaxisStatus,
            } = xAxisConfig;
            let {
                ylabel,
                yboldLabel,
                yitalicLabel,
                yboldTick,
                yitalicTick,
                yaxisStatus,
            } = yAxisConfig;
            window.yboldLabel = yboldLabel;
            window.xboldLabel = xboldLabel;
            window.xitalicLabel = xitalicLabel;
            window.yitalicLabel = yitalicLabel;
            if (!xAxisConfig.xlabel && !yAxisConfig.ylabel) {
                [xAxisLabel, yAxisLabel] = data[1];
            } else {
                [xAxisLabel, yAxisLabel] = [
                    xAxisConfig.xlabel,
                    yAxisConfig.ylabel,
                ];
            }
            const d3Colors = d3colorPalette;
            // set the dimensions and margins of the graph
            var margin = { top: 30, right: 30, bottom: 70, left: 60 },
                width = window.innerWidth - margin.left - margin.right - 20,
                height = window.innerHeight - margin.top - margin.bottom - 30;

            let { gridStatus } = gridConfig;
            let { legendStatus, legendPosition } = legendConfig;
            if (!legendConfig) {
                legendConfig = { legendStatus: false };
            }

            if (!innerRadius) {
                innerRadius = defaultD3Config.innerRadius;
            }
            if (!toolTip) {
                toolTip = {
                    textColumn1: xAxisLabel,
                    textColumn2: yAxisLabel,
                    colorData: colorData,
                };
            }

            // set the dimensions and margins of the graph
            d3.selectAll("#my_dataviz").html("");
            d3.selectAll("#yAxisDiv").html("");
            d3.select("#legend").attr("style", null);
            d3.select("#mainChartWindow").attr("style", null);
            d3.select("#xAxisLabelId").style("bottom", 20);

            // // set the dimensions and margins of the graph
            // var margin = { top: 10, right: 30, bottom: 30, left: 60 },
            //     width = 1300 - margin.left - margin.right,
            //     height = 600 - margin.top - margin.bottom;

            // legends code starts
            d3.select("#legend").html("").style("padding", "");
            if (legendStatus) {
                d3.select("#legend").html("");

                d3.select("#legend")
                    .append("p")
                    .html(colorData + "&nbsp;")
                    .style("font-weight", "bold")
                    .style("margin", "auto")
                    .style("position", "sticky");

                d3.select("#legend")
                    .selectAll("div")
                    .data(data[2])
                    .enter()
                    .append("div")
                    .html((d, i) => {
                        return (
                            '<div style="width: 15px; height: 15px; margin-top:2px; background: ' +
                            d3Colors[i % d3Colors.length] +
                            ';">  </div>' +
                            "<span style='margin-left: 5px; max-width: 160px'>" +
                            d +
                            "</span>"
                        );
                    })
                    .style("display", "flex")
                    .style("padding", "2px");
            }

            // legends code ends

            // legends height ,width elements
            var legendElement = document.querySelector("#legend");
            var legendHeight = legendElement.offsetHeight;
            var legendWidth = legendElement.offsetWidth;

            const yAxisWidth = document.querySelector("#yAxisDiv").clientWidth;

            d3.select("#legend").attr("style", null);
            d3.select("#mainChartWindow").attr("style", null);
            d3.select("#xAxisLabelId").style("bottom", 20);

            // append the svg object to the body of the page
            var svg = d3
                .select("#my_dataviz")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr(
                    "transform",
                    "translate(" + margin.left + "," + margin.top + ")"
                );

            // legends code starts

            if (legendStatus) {
                if (
                    legendHeight < document.querySelector("html").offsetHeight
                ) {
                    topPosition = "calc(50vh - " + legendHeight / 2 + "px)";
                } else {
                    topPosition = 0;
                }
                rightPosition = "calc(50vw - " + legendWidth / 2 + "px)";

                //  var widthOld = (document.querySelector("#my_dataviz").clientWidth) ;
                var widthOld = document.querySelector("html").clientWidth - 72;
                var heightOld = document.querySelector("html").clientHeight;

                // legendElement.style.padding = "10px";
                legendElement.style.border = "1px solid black";
                d3.selectAll("#my_dataviz").style("margin-top", 0 + "px");

                switch (legendPosition) {
                    case "left":
                        d3.select("#legend")
                            .attr("style", null)
                            .style("top", topPosition)
                            .style("right", "auto")
                            // .style("bottom", "auto")
                            .style("left", "0px")
                            // .style("right", "5px")
                            .style("display", "block")
                            .style("max-height", "100vh")
                            .style("overflow", "scroll")
                            .style("border", "none")
                            .style("position", "fixed");
                        d3.selectAll("#legend div span")
                            .style("max-width", "160px")
                            .style("white-space", "nowrap")
                            .style("overflow", "hidden")
                            .style("text-overflow", "ellipsis");

                        var legendWidth = legendElement.offsetWidth;
                        // margin.left += 100;
                        // width -= 100;
                        // d3.select("#my_dataviz svg").attr("width", width + margin.left + margin.right);

                        d3.select("#mainChartWindow").attr("style", null);

                        d3.select("#mainChartWindow").style(
                            "width",
                            widthOld - legendWidth + yAxisWidth
                        );
                        d3.select("#mainChartWindow").style(
                            "margin-left",
                            legendWidth + "px"
                        );
                        d3.select("#xAxisLabelId").style("bottom", 10 + "px");
                        d3.selectAll("#my_dataviz").style(
                            "height",
                            "calc(100vh)"
                        );

                        break;
                    case "top":
                        d3.select("#mainChartWindow").attr("style", null);
                        // margin.top += 50;
                        height -= 50;
                        y_pos_x_label = 57;
                        d3.select("#legend")
                            .attr("style", null)
                            .style("top", "10px")
                            .style("right", rightPosition)
                            .style("bottom", "auto")
                            .style("left", "auto")
                            .style("display", "flex")
                            .style("max-width", "99vw")
                            .style("overflow", "scroll")
                            .style("border", "none");
                        d3.selectAll("#legend div span")
                            .style("max-width", "160px")
                            .style("white-space", "nowrap")
                            .style("overflow", "hidden")
                            .style("text-overflow", "ellipsis");
                        d3.select("#xAxisLabelId").style("bottom", 10 + "px");
                        d3.selectAll("#my_dataviz").style(
                            "height",
                            "calc(100vh - 72px) "
                        );
                        d3.selectAll("#my_dataviz").style(
                            "margin-top",
                            50 + "px"
                        );

                        // d3.selectAll("#legend div").style(
                        //     "padding",
                        //     "2px 4px"
                        // );
                        break;
                    case "bottom":
                        height -= 50; // use legend client height
                        margin.bottom += 10;
                        var legendWidth = legendElement.offsetWidth;
                        y_pos_x_label = 20;

                        d3.select("#xAxisLabelId").style("bottom", "60px");
                        d3.select("#mainChartWindow").attr("style", null);

                        // d3.select("#mainChartWindow").style("width", width);
                        //  d3.select("#mainChartWindow").style("height",heightOld-80 );
                        d3.select("#mainChartWindow").style("margin-left", 0);
                        d3.select("#legend")
                            .attr("style", null)
                            .style("top", "auto")
                            .style("right", rightPosition)
                            .style("bottom", "0px")
                            // .style("left", margin.left + "px")
                            .style("display", "flex")
                            .style("max-width", "99vw")
                            .style("overflow", "scroll")
                            .style("border", "none");

                        d3.selectAll("#legend div span")
                            .style("max-width", "160px")
                            .style("white-space", "nowrap")
                            .style("overflow", "hidden")
                            .style("text-overflow", "ellipsis");
                        d3.selectAll("#my_dataviz").style(
                            "height",
                            "calc(100vh - 42px)"
                        );

                        break;
                    // For Right Legened
                    case "right":
                    default:
                        // width -= 220;
                        // d3.select("#my_dataviz").style("width", width + margin.left + margin.right);
                        var legendWidth = legendElement.offsetWidth;

                        d3.select("#legend")
                            .attr("style", null)
                            .style("right", "0px")
                            .style("left", "auto")
                            .style("position", "fixed")
                            .style("top", topPosition)
                            .style("max-height", "100vh")
                            .style("overflow", "scroll")
                            .style("border", "none")
                            .style("bottom", "auto")
                            .style("display", "block");
                        d3.selectAll("#legend div span")
                            .style("max-width", "160px")
                            .style("white-space", "nowrap")
                            .style("overflow", "hidden")
                            .style("text-overflow", "ellipsis");

                        d3.select("#mainChartWindow").attr("style", null);
                        d3.select("#mainChartWindow").style(
                            "width",
                            widthOld - legendWidth + yAxisWidth - 10 + "px"
                        );
                        d3.select("#mainChartWindow").style("margin-left", 0);
                        d3.select("#xAxisLabelId").style("bottom", 10 + "px");
                        d3.selectAll("#my_dataviz").style(
                            "height",
                            "calc(100vh)"
                        );
                }
            }

            if (legendPosition == "left" || legendPosition == "right") {
                var legendWidth = legendElement.offsetWidth;
                width -= legendWidth;
            }

            // legends code ends

            var dataValues = data[0];

            var xRange = d3.extent(dataValues, function (d) {
                return +d[0];
            });
            // Add X axis
            var x = d3.scaleLinear().domain(xRange).range([0, width]).nice();

            if (xRange[0] > 0) {
                xRange[0] = 0;
            }

            svg.append("g")
                .attr("transform", "translate(0," + height + ")")
                .call(d3.axisBottom(x).tickSizeOuter(0))
                .attr("class", "x-axis");

            // svg.append("g")
            //     .attr("class", "grid")
            //     .attr("transform", "translate(0," + height + ")")
            //     .style("stroke-width", "1")
            //     .call(make_x_gridlines().tickSize(-height).tickFormat(""));

            var yRange = d3.extent(dataValues, function (d) {
                return +d[1];
            });

            if (yRange[0] > 0) {
                yRange[0] = 0;
            }
            console.log(yRange);

            // Add Y axis
            var y = d3.scaleLinear().domain(yRange).range([height, 0]).nice();
            svg.append("g")
                .call(d3.axisLeft(y).tickSizeOuter(0))
                .attr("class", "y-axis");

            if (gridStatus) {
                svg.append("g")
                    .attr("class", "grid")
                    .style("stroke-width", "1")
                    .call(make_y_gridlines().tickSize(-width).tickFormat(""));
            }

            // Color scale: give me a specie name, I return a color
            var color = d3.scaleOrdinal().domain(categories).range(d3Colors);

            // Add dots
            svg.append("g")
                .selectAll("dot")
                .data(dataValues)
                .enter()
                .append("circle")
                .attr("cx", function (d) {
                    return x(+d[0]);
                })
                .attr("cy", function (d) {
                    return y(+d[1]);
                })
                .attr("r", function (d, i) {
                    if (i == 0 && d.length == 2) {
                        return 0;
                    }
                    return 5;
                })
                .style("fill", function (d) {
                    return color(d[2]);
                })
                .attr("class", function (d, i) {
                    return "scatter" + i + d[2];
                })

                .on("mouseover mousemove", function (d, i) {
                    var x_pos = d3.mouse(this)[0] - 20;
                    var y_pos = d3.mouse(this)[1] - 30;

                    d3.select("#tooltip")
                        // .style("left", x_pos + 90 + "px")
                        .style("top", y_pos + 10 + "px")
                        .style("display", "block")
                        // .html(
                        //     data[1][0] +
                        //         ": " +
                        //         d[0] +
                        //         "<br>" +
                        //         data[1][1] +
                        //         ": " +
                        //         d[1]
                        // );
                        .html(function () {
                            var textValue = d.y0 - d.y1;
                            if (d.y1 < 0) {
                                textValue = d.y1 - d.y0;
                            }

                            return (
                                "<div class='arrowTooltip'></div>" +
                                "<span style='color:grey;''>" +
                                toolTip.colorData +
                                ":" +
                                "</span>" +
                                "<span style='float: right;margin-left: 15px;'>" +
                                d[2] +
                                "</span>" +
                                "<br/> <br/>" +
                                "<span style='color:grey;''>" +
                                toolTip.textColumn1 +
                                ":&nbsp;&nbsp;" +
                                "</span>" +
                                "<span style='float: right;'>" +
                                d[0] +
                                "</span>" +
                                "<br/> <br/>" +
                                "<span style='color:grey;''>" +
                                toolTip.textColumn2 +
                                ":" +
                                "</span>" +
                                "<span style='float: right;margin-left: 15px;'>" +
                                d[1] +
                                "</span>"
                            );
                        });
                    var scrollVal =
                        document.querySelector("#my_dataviz").scrollLeft;

                    if (
                        x_pos - scrollVal >
                        document.documentElement.clientWidth -
                            document.querySelector("#tooltip").clientWidth -
                            40
                    ) {
                        d3.select("#tooltip").style(
                            "left",
                            x_pos -
                                scrollVal -
                                document.querySelector("#tooltip").clientWidth +
                                70 +
                                "px"
                        );

                        d3.select(".arrowTooltip")
                            //  document.querySelector("#tooltip:before")
                            // .style("height","50px";"width","50px";"background-color","red";")

                            .attr(
                                "style",
                                "border: solid; border-color: white transparent; border-width: 12px 6px 0 6px; content: '';right: -12px; transform: rotate(-90deg)!important;bottom: 22px; position: absolute;"
                            );
                    } else {
                        d3.select("#tooltip").style(
                            "left",
                            x_pos - scrollVal + 95 + "px"
                        );

                        d3.select(".arrowTooltip").attr(
                            "style",
                            "border: solid; border-color: white transparent; border-width: 12px 6px 0 6px; content: '';left: -12px; transform: rotate(90deg)!important;bottom: 22px; position: absolute;"
                        );
                    }

                    d3.select(".scatter" + i + d[2]);

                    d3.select(this).attr("r", 10);
                })

                .on("mouseout", function (d, i) {
                    d3.select("#tooltip").style("display", "none");
                    d3.select(".scatter" + i + d[2]);

                    d3.select(this).attr("r", 5);
                });

            if (labelStatus) {
                svg.selectAll(".dot")
                    .data(dataValues)
                    .enter()
                    .append("text")
                    .attr("class", "dataLabel")
                    .text(function (d, i) {
                        // this.setAttribute("data-value-x", d[0]);
                        // this.setAttribute("data-value-x1", d[1]);

                        // this.setAttribute("data-value-y", d[2]);

                        if (!d[2]) {
                            return "";
                        }
                        return labelFormatSet(d[1], labelFormat);
                    })
                    .attr("x", function (d) {
                        return x(+d[0]);
                    })
                    .attr("y", function (d) {
                        return y(+d[1]);
                    })
                    .attr("font-family", dataLabelfontFamily)
                    .attr("font-size", dataLabelfontSize)
                    .attr("fill", dataLabelColor);
            }
            // d3.select("#yAxisDiv")
            //     .append("svg")
            //     .attr("width", "72")
            //     .attr("height", height + margin.top + margin.bottom)
            //     .append("g") //add group to leave margin for axis
            //     .attr(
            //         "transform",
            //         "translate(" + (margin.left + 11) + "," + margin.top + ")"
            //     )
            //     .append("g")
            //     .attr("class", "y-axis")
            //     // svg.append("g")
            //     //     .attr("class", "y-axis")
            //     .call(d3.axisLeft(y).tickSizeOuter(0))
            //     .call(y);

            // var yAxisDiv = document.querySelector("#yAxisDiv svg");
            // Generate Grid starts

            d3.selectAll(".y-axis text")
                .attr("font-size", yTickfontSize)
                .attr("font-family", yTickfontFamily)
                .attr("font-weight", yboldTick ? "bold" : "regular")
                .attr("font-style", yitalicTick ? "italic" : "regular")
                .attr("fill", yTickfontColor);
            d3.selectAll(".x-axis text")
                .attr("font-size", xTickfontSize)
                .attr("font-family", xTickfontFamily)
                .attr("font-weight", xboldTick ? "bold" : "regular")
                .attr("font-style", xitalicTick ? "italic" : "regular")
                .attr("fill", xTickfontColor)
                .attr("y", 8);
                 if (xaxisStatus) {
                    d3.selectAll("g .x-axis").attr("style", "display: block");
                } else {
                    d3.selectAll("g .x-axis").attr("style", "display: none");
                }
                if (yaxisStatus) {
                    d3.selectAll("g .y-axis").attr("style", "display: block");
                } else {
                    d3.selectAll("g .y-axis").attr("style", "display: none");
                }

            function make_x_gridlines() {
                return d3.axisBottom(x).ticks(8);
            }
            function make_y_gridlines() {
                return d3.axisLeft(y).ticks(5);
            }
            setLabel(
                xAxisLabel,
                "x_label",
                d3
                    .select("#xAxisLabelId")
                    .append("svg")
                    .attr("width", window.innerWidth, "height", 150),
                30,
                false
            );
            setLabel(yAxisLabel, "y_label", d3.select("svg"), false);
        }

        drawChart(data);

        // Generate Grid ends
        // });
    </script>
</body>
